---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const articles = await getCollection('articles');
  return articles.map((article) => ({
    params: { slug: article.slug },
    props: { article },
  }));
}

const { article } = Astro.props;
const { Content } = await article.render();

// Format the date
const formattedDate = new Date(article.data.date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});

// Get more articles
const allArticles = await getCollection('articles');
const moreArticles = allArticles
  .filter(a => a.slug !== article.slug)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 3);
---

<BaseLayout 
  title={`${article.data.title} | Clay Target Instruction`} 
  description={article.data.description}
>
  <article>
    {/* Article Header */}
    <div class="border-b border-surface-anchor">
      <div class="max-w-4xl mx-auto px-6 py-16">
        <a href="/articles" class="text-primary hover:opacity-80 transition-opacity inline-flex items-center gap-2 mb-8 text-lg font-medium">
          ← Back to Articles
        </a>
        
        <h1 class="text-4xl md:text-5xl lg:text-6xl font-heading font-bold text-text-primary leading-tight mb-8">
          {article.data.title}
        </h1>
        
        <div class="flex items-center gap-4 text-lg">
          <span class="text-primary font-semibold text-xl">{article.data.author}</span>
          <span class="text-surface-lava">•</span>
          <time datetime={article.data.date.toISOString()} class="text-text-secondary">
            {formattedDate}
          </time>
        </div>
      </div>
    </div>

    {/* Article Content */}
    <div class="max-w-4xl mx-auto px-6 py-16">
      {/* Featured Image */}
      {article.data.image && (
        <img 
          src={article.data.image} 
          alt={article.data.title}
          class="w-full rounded-xl mb-16 shadow-lg"
        />
      )}
      
      {/* Article Body with Custom Styles */}
      <div class="article-content">
        <Content />
      </div>

      {/* Author Box */}
      <div class="mt-20 p-10 bg-surface/50 rounded-xl border border-surface-anchor">
        <h3 class="text-3xl font-heading font-bold text-text-primary mb-6">
          About {article.data.author}
        </h3>
        <p class="text-xl text-text-primary leading-relaxed">
          {article.data.author === 'Anthony Matarese' || article.data.author === 'Anthony I. Matarese Jr.' ? (
            'Anthony Matarese Jr. is a 7-time National Champion and World FITASC Champion. The youngest person ever inducted into the NSCA Hall of Fame, Anthony has revolutionized clay target instruction with his systematic approach to shooting excellence.'
          ) : article.data.author === 'George Digweed' || article.data.author === 'George Digweed MBE' ? (
            'George Digweed MBE is the most decorated clay shooter in history with 28+ World Championships. Awarded an MBE by the Queen for his contributions to the sport, George continues to dominate competitions while sharing his legendary swing-through method with shooters worldwide.'
          ) : article.data.author === 'Zachary Kienbaum' || article.data.author === 'Zach Kienbaum' ? (
            'Zachary Kienbaum is the 2024 FITASC World Champion and 3-time NSCA National Champion. A 28-time All-American and frequent Team USA captain, Zach brings elite competition experience and proven teaching methodology to every lesson.'
          ) : (
            'One of our expert instructors sharing decades of competitive shooting experience and proven teaching methods.'
          )}
        </p>
      </div>
    </div>

    {/* More Articles */}
    {moreArticles.length > 0 && (
      <div class="border-t border-surface-anchor">
        <div class="max-w-4xl mx-auto px-6 py-20">
          <h2 class="text-4xl font-heading font-bold text-text-primary mb-12">
            More Articles
          </h2>
          <div class="space-y-8">
            {moreArticles.map((article) => (
              <a href={`/articles/${article.slug}`} class="block group">
                <h3 class="text-2xl font-heading font-semibold text-text-primary group-hover:text-primary transition-colors mb-3">
                  {article.data.title}
                </h3>
                <p class="text-xl text-text-primary/80 leading-relaxed">
                  {article.data.description}
                </p>
              </a>
            ))}
          </div>
          
          <div class="mt-16 pt-16 border-t border-surface-anchor">
            <a 
              href="/articles" 
              class="text-primary text-xl font-semibold hover:opacity-80 transition-opacity inline-flex items-center gap-2"
            >
              View All Articles →
            </a>
          </div>
        </div>
      </div>
    )}
  </article>

  <style is:global>
    /* Custom article content styles for maximum readability */
    .article-content {
      font-size: 1.125rem; /* 18px base */
      line-height: 1.75;
      color: #FFFFFF;
    }

    .article-content p {
      margin-bottom: 1.75rem;
      color: #FFFFFF;
      font-size: 1.125rem; /* 18px */
      line-height: 1.75;
    }

    /* Headings with strong visual hierarchy */
    .article-content h1 {
      font-size: 2.75rem !important; /* 44px */
      font-weight: 800 !important;
      margin-top: 3rem !important;
      margin-bottom: 1.5rem !important;
      color: #FFFFFF !important;
      font-family: var(--font-heading) !important;
      line-height: 1.2 !important;
    }

    .article-content h2 {
      font-size: 2.25rem !important; /* 36px */
      font-weight: 700 !important;
      margin-top: 3rem !important;
      margin-bottom: 1.5rem !important;
      color: #FF6B1A !important;
      font-family: var(--font-heading) !important;
      line-height: 1.3 !important;
    }

    .article-content h3 {
      font-size: 1.75rem !important; /* 28px */
      font-weight: 700 !important;
      margin-top: 2.5rem !important;
      margin-bottom: 1.25rem !important;
      color: #FFFFFF !important;
      font-family: var(--font-heading) !important;
    }

    .article-content h4 {
      font-size: 1.75rem !important; /* 28px */
      font-weight: 600 !important;
      margin-top: 2.5rem !important;
      margin-bottom: 1.25rem !important;
      color: #FFFFFF !important;
      font-family: var(--font-heading) !important;
    }

    /* Lists */
    .article-content ul,
    .article-content ol {
      margin-bottom: 2rem;
      padding-left: 2rem;
    }

    .article-content li {
      margin-bottom: 1rem;
      color: #FFFFFF;
      font-size: 1.375rem; /* 22px */
      line-height: 1.9;
    }

    .article-content ul li::marker {
      color: #FF6B1A;
    }

    .article-content ol li::marker {
      color: #FF6B1A;
      font-weight: 600;
    }

    /* Links */
    .article-content a {
      color: #FF6B1A;
      text-decoration: underline;
      text-decoration-thickness: 2px;
      text-underline-offset: 4px;
      transition: opacity 0.2s;
    }

    .article-content a:hover {
      opacity: 0.8;
    }

    /* Strong text */
    .article-content strong,
    .article-content b {
      font-weight: 700;
      color: #FFFFFF;
    }

    /* Blockquotes */
    .article-content blockquote {
      border-left: 4px solid #FF6B1A;
      background: rgba(30, 30, 30, 0.5);
      padding: 2rem;
      margin: 2.5rem 0;
      border-radius: 0 0.5rem 0.5rem 0;
      font-style: italic;
      font-size: 1.375rem; /* 22px */
    }

    .article-content blockquote p {
      margin-bottom: 0;
    }

    /* Code */
    .article-content code {
      background: #1E1E1E;
      color: #FF6B1A;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 1.125rem;
      font-family: monospace;
    }

    .article-content pre {
      background: #1E1E1E;
      border: 1px solid #2A2A2A;
      border-radius: 0.5rem;
      padding: 1.5rem;
      overflow-x: auto;
      margin: 2rem 0;
    }

    .article-content pre code {
      background: none;
      padding: 0;
      font-size: 1rem;
    }

    /* Images */
    .article-content img {
      border-radius: 0.75rem;
      margin: 2.5rem 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }

    /* Tables */
    .article-content table {
      width: 100%;
      border-collapse: collapse;
      margin: 2rem 0;
      font-size: 1.125rem;
    }

    .article-content th {
      background: #1E1E1E;
      padding: 1rem;
      text-align: left;
      font-weight: 700;
      color: #FFFFFF;
      border: 1px solid #2A2A2A;
    }

    .article-content td {
      padding: 1rem;
      border: 1px solid #2A2A2A;
      color: #F2F2F2;
    }

    /* Horizontal rules */
    .article-content hr {
      border: none;
      border-top: 2px solid #2A2A2A;
      margin: 3rem 0;
    }

    /* First paragraph - make it larger */
    .article-content > p:first-of-type {
      font-size: 1.625rem !important; /* 26px */
      line-height: 1.8 !important;
      color: #FFFFFF !important;
      margin-bottom: 3rem !important;
      font-weight: 500 !important;
    }

    /* Add visual separation between sections */
    .article-content h1 + p,
    .article-content h2 + p,
    .article-content h3 + p {
      margin-top: 0.5rem;
    }

    /* Style list items better */
    .article-content ul {
      background: rgba(255, 107, 26, 0.05);
      border-left: 4px solid #FF6B1A;
      padding: 1.5rem 2rem 1.5rem 3rem;
      border-radius: 0 8px 8px 0;
      margin: 2rem 0;
    }

    .article-content ol {
      counter-reset: item;
      padding-left: 0;
    }

    .article-content ol li {
      counter-increment: item;
      position: relative;
      padding-left: 3rem;
    }

    .article-content ol li::before {
      content: counter(item);
      position: absolute;
      left: 0;
      top: 0;
      background: #FF6B1A;
      color: #0A0A0A;
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.125rem;
    }
  </style>
</BaseLayout>